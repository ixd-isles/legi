<!DOCTYPE html>
<html>
  <head>
    <title>Legistar Test</title>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
    <style>
 	html, body, #map {
        height: 100%;
        padding: 0;
        margin: 0;
      }
	  
	  #locate-position{
 	 position:absolute;
	  top:140px;
 	 left:22px;
 	 -webkit-box-shadow: 0px 0px 5px 0px rgba(0,0,0,0.75);
 	 -moz-box-shadow: 0px 0px 5px 0px rgba(0,0,0,0.75);
 	 box-shadow: 0px 0px 5px 0px rgba(0,0,0,0.75);

 	 background-color:#ffffff;
	  border: solid 1px #999999;
	  border-radius: 3px;
	  height: 28px;
	 width:28px;
	}
    </style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js" integrity="sha512-dfX5uYVXzyU8+KHqj8bjo7UkOdg18PaOtpa48djpNbZHwExddghZ+ZmzWT06R5v6NSk3ZUfsH6FNEDepLx9hPQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

</head>

<body>
<script>

var crossArray = [];


function legiQuery(a) {
	for (let i=1; i<=2; i++) {
		var listFile = a[i][4];
		console.log(listFile);
	//	crossArray[i].push(listFile);
		var legiCall = encodeURI("https://webapi.legistar.com/v1/newark/matters?$filter=MatterFile eq '" + listFile + "'&format=json&callback=cupcake");
	console.log(legiCall);
	const xhr = new XMLHttpRequest();
	var cleanLink = "https://cloudquery.t9t.io/query?url=" + legiCall;
	console.log(cleanLink);
	xhr.open("GET", cleanLink);
	xhr.send();




	
		
	}

}

var file = "https://raw.githubusercontent.com/ixd-isles/legi/main/LegiTest.csv";
Papa.parse(file, {download:true, 
	complete: function(result) {
	legiQuery(result.data);
}});


</script>

</body>
</html>
